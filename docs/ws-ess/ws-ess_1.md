# 第一章：介绍网络应用程序的世界

HTML5 和 WebSockets 使网络应用程序开发达到了新的水平。网络开发技术的革命性改进为开发人员提供了现代工具和技术。使用 WebSockets，他们可以创建不仅可以从客户端发送数据，还可以从服务器端发送数据的网络应用程序。使用实时数据传输的网络应用程序可以以更低的带宽使用率创建。通过补充 HTML5 增强功能，WebSockets 可以使未来的应用程序更加强大。在深入了解 WebSockets 之前，让我们先了解网络的基础知识。

# 什么是网络？

网络的基础是在八十年代末奠定的。网络是通过互联的超文本文档工作的，我们可以使用互联网访问它们。浏览器在阅读和转换这些超文本文档成为可读和更有意义的格式方面发挥着至关重要的作用，我们称之为网页。HTML5 是浏览器读取和呈现给我们的超文本文档。浏览器不仅读取和呈现，还为我们创建了**文档对象模型**（**DOM**），以便我们可以轻松地阅读和操作结构。DOM 的动态操作可以通过 JavaScript 语言实现，这是 HTML 的标准脚本语言。服务器在网络的运作中起着至关重要的作用。我们主要认为网络分为两部分：客户端和服务器。客户端被认为是浏览器，而服务器是给客户端提供数据的一方。

让我们看看网络是如何工作的：

1.  浏览器从服务器请求 URL。

1.  服务器检查并返回 HTML 文件。

1.  浏览器引擎绘制页面。

简而言之，这就是网络的工作原理。浏览器和服务器是网络中最重要的实体。浏览器有引擎来读取 HTML 文件，并以 HTML 文件描述的方式呈现网络应用程序。不同的浏览器，如 Blink、Trident、Gecko、WebKit 等，有不同的引擎来呈现页面的 HTML。现在服务器是存储所有数据并在用户请求时提供数据的一方。

# 网络应用程序

在网络的早期，页面是静态的。它们只用于显示最少的交互和功能性内容。但随着网络标准的进步，计算机的发展，高效的浏览器，增强的工具和库，创建网络应用程序现在变得非常容易，许多功能可以很快地添加进去。

这里有一个简单的网络应用程序定义 - 任何在浏览器上运行的应用程序都是网络应用程序。我们在日常生活中使用许多网络应用程序来检查邮件，阅读新闻，观看视频等。网络应用程序在您的浏览器中运行，不需要太多的计算机资源。

网络正在以非常快的速度增长。许多公司正在网络上构建他们的应用程序。第一个和最重要的好处是它独立于操作系统。您可以在 Windows、Mac 或 Linux 上运行它，它的工作方式是相同的，因为工作主要由浏览器完成，并且它们适用于大多数操作系统。

以下是一些网络应用程序的示例：

+   Gmail

+   Dropbox

+   Flickr

+   Facebook

# WebSockets 的作用是什么？

我们已经看到了一些 Web 应用程序的例子，现在问题是 WebSockets 在这些应用程序或任何 Web 应用程序中的位置在哪里？让我们首先了解一些应用程序行为；让我们以 Gmail 为例，它基本上是一个邮件客户端。邮件客户端的工作是获取邮件并显示它们。这听起来很简单，但当有人给你发送一封邮件，你希望立即显示该邮件时，问题就出现了。为了实现这样的功能，有不同的方式，如轮询和长轮询，这些方式都不高效。因此，WebSockets 通过提供服务器推送功能来解决这个问题。WebSockets 提供了从客户端和服务器端推送的功能，这使它脱颖而出。

WebSockets 具有一些良好的特性和优点，超过了其他通信方法。WebSockets 的一些特性和优点包括：

+   全双工通信

+   低带宽消耗

+   安全性

+   低延迟

+   在传输控制协议（TCP）上运行（尽管它需要 HTTP 进行初始握手）

+   几乎所有的网络浏览器和服务器都支持，包括移动浏览器

我们可以将 WebSockets 视为增强 Web 应用体验的功能。借助 HTML5 增强的功能，我们可以创建动态和实时的应用程序。

# WebSockets 相对于其他方法

有不同的方式来实现客户端和服务器之间的数据通信。Flash，Comet，PusherApp 等都提供了 WebSockets 所需的功能。那么问题来了，为什么我们要选择 WebSockets 呢？有很多原因可以选择 WebSockets 而不是其他方法，其中一些原因如下：

+   与其他数据通信方式相比，WebSockets 表现出低延迟，从近 150 毫秒减少到 50 毫秒。

+   WebSockets 是一种轻量级连接，使用带宽较低。

+   在学习和实施不同技术方面，需要更少的开发人员工作量。

+   在使用不同技术时编译更容易。

+   使用 WebSockets 可以轻松进行代码维护。

+   WebSockets 提供了全双工连接支持，而没有太多的开销。

# 现代浏览器

现代浏览器配备了先进的功能，以支持 Web 应用程序。

Web 应用程序具有许多不同的功能，为了支持这些功能，我们需要的不仅仅是普通的浏览器，而是现代浏览器。为了支持 HTML5 提供的高级功能，现代浏览器必须实现 HTML5 标准，因为它具有最新的功能和功能。有一些浏览器的版本不支持 HTML5，主要是因为它们没有实现 HTML5 标准，要么是因为它们是早期开发的，要么是因为它们选择不支持。

现代浏览器的一些优势如下：

+   良好的性能

+   良好的安全性

+   问题更少

+   页面加载更快

+   实验性的应用程序编程接口或 API

+   支持最新的功能

+   访问本机资源

# HTML

HTML 是一种标记语言，用于浏览器呈现网页。这是由万维网联盟（W3）制定的标准。这个标准有一些定义的元素，不同的浏览器实现了这些元素。

# HTML5-现代 Web 标准

在八年的 HTML5 标准制定工作之后，W3 于 2014 年 10 月 28 日最终确定了这一标准。这个标准将对未来的网络产生革命性的影响。对 HTML 标准的增强是革命性的。让我们来看看 HTML5 的主要特性，使其成为 Web 的一个伟大标准：

## 媒体-音频/视频

HTML5 标准引入的一个重要功能是媒体播放。现在我们可以直接使用浏览器播放音频/视频。以前，我们需要使用一些插件来播放音频和视频，这为我们的网络应用程序增加了另一层。例如，YouTube 使用 Flash 播放器播放视频，但现在我们可以直接播放视频。这个功能对完全使用 HTML 构建的应用程序来说是一个更大的优势。

除了播放音频和视频之外，我们还可以捕获设备的音频和视频资源。可以使用`getUserMedia()` API 来访问摄像头和麦克风，但由于它是一个实验性功能，因此并不是所有浏览器都支持它；但这是一个非常需要的功能。这个 API 不仅可以访问台式电脑，还可以访问移动设备和平板电脑上的摄像头和麦克风。这是另一个将消除对媒体访问和捕获的不同插件的依赖的功能。

## Canvas

Canvas 允许您在运行时以每个像素的方式进行操作。因此，您可以绘制形状，渲染图形，着色，操作它们，甚至以每个像素操作位图图像，以及许多其他功能。Canvas 功能使我们在绘制和制作网络应用程序方面具有优势，就像 Microsoft Paint（以前的 Microsoft Paintbrush）或 Adobe Photoshop 一样。

Canvas 元素具有一组不同的方法，可以使用线条、圆圈、框、文本、图形等来创建绘图。JavaScript 用于在画布容器中绘制。

## 表单元素

表单元素中有许多增强功能，可以帮助我们为用户创建出色的体验，并且从开发人员的角度来看易于管理。验证以前是一个大问题；我们不得不为此编写自己的代码，但现在它是元素的一部分。有一些增强功能是为移动设备而设计的，例如字段类型键盘，例如专门用于数字字段的键盘。一些新元素包括：

+   **Input**：以下是输入类型：

+   `type="email"`：具有内置电子邮件验证器的字段

+   `type="url"`：具有内置 URL 验证器的字段

+   `type="number"`：具有内置数字输入限制和验证器的字段

+   `type="range"`：具有最大和最小功能的范围滑块

+   **Datalist**：它指定了列表控件的预定义选项列表。

+   **Keygen**：该元素使用公钥/私钥方法提供安全数据提交。从安全性的角度来看，这是一个很好的增强功能。

+   **Output**：这个元素有助于在填写表单时显示输出值。

## 语义

语义是具有含义的元素。每个开发人员都希望用易于理解和实现的语言编码。语义是使代码更易于阅读和理解的因素，因为它定义了该元素或标记的含义。语义元素的一些示例包括`<audio>`、`<video>`、`<form>`和`<table>`。非语义元素的示例包括`<div>`和`<span>`。从这些示例中我们可以看出，非语义元素并没有告诉我们有关内容，而语义元素清楚地告诉我们有关内容。

HTML5 中的一些新语义如下：

+   `<section>`

+   `<nav>`

+   `<article>`

+   `<aside>`

+   `<hgroup>`

+   `<header>`

+   `<footer>`

这些新元素的添加将有助于使代码更易读和有意义。现在让我向您介绍自定义元素。是的，现在我们可以使用 JavaScript 制作自己的自定义元素，可以从头开始创建它们，也可以通过向 DOM 元素的默认集合添加新行为来扩展它们。这样，我们可以创建不同的可重用网络组件集，并在整个网络应用程序中使用它们。这个功能为代码增加了意义，并且对于大型应用程序来说，制作可重用的网络组件是一个巨大的优势。

## 首先移动

HTML5 和 CSS3 标准是为移动设备而制定的。有许多增强功能可以优化移动/平板设备的代码。手机已经发展到一个程度，已经成为我们日常生活的一部分。我们已经开始更多地在移动/平板设备上浏览互联网。HTML5 已经赋予 Web 很多力量，以满足现代 Web 的需求。HTML5 和 CSS3 具有一些出色的功能，可以为所有设备提供相同的内容：台式机、移动设备和平板电脑。一些重要的功能包括以下内容：

+   **视口**：这有助于根据设备调整网页的视图。我们可以设置不同的缩放级别等。

+   **媒体查询**：根据屏幕大小的 CSS；这不是一个很棒的功能吗？现在通过使用媒体查询，CSS 样式可以在运行时更改。响应式网页设计是现代 Web 的一个非常重要的特性。我们需要根据屏幕大小显示内容，并且它应该适应并显示适当的内容，消除页面上对于较小设备来说不那么重要的内容。

+   **触摸事件**：这些对于移动/平板设备非常重要。**滑动**是现在 HTML5 DOM 的重要事件之一。

## 离线存储

世界正在不断涌现出不同的技术，我们广泛使用在线和网络服务，以创建一个有效的工作空间和一个满足我们专业和个人需求的网络世界。有些情况下，您需要网站在离线状态下也能访问，即在设备上没有活动的互联网连接。这可以通过使用离线存储功能来实现。一旦您打开了一个网页，就可以将数据放入缓存，这样下次您打开它，或者由于某种原因您的连接丢失，您仍然可以打开并使用它。

当数据需要本地存储时，离线系统非常重要，特别是当系统处于离线模式时需要重新加载或恢复页面时。

因此，每当我们打开一个 URL 时，它基本上会访问服务器，然后服务器返回请求的文件。然后，浏览器呈现服务器提供的文件。现在，如果我们处于离线状态，浏览器将接管控制，而不是访问服务器获取文件，它会从先前打开时缓存的本地副本中加载文件。还有一个 API 可以告诉我们是在线还是离线。在移动/平板设备的情况下，这非常有帮助，因为连接可能随时丢失。

## 地理定位

有许多应用程序使用地理定位，如 Twitter、Facebook、Foursquare、Google Maps 等。将此功能作为 HTML5 的一部分引入，使开发人员更容易获取其设备的位置。

移动和平板设备具有**全球定位系统**（**GPS**），并且可以使用此 API 访问设备的硬件。让我们以一个应用程序为例，您想要找到附近的酒店。使用 GPS，可以检测到您的位置，并提供附近酒店的相应列表。这个功能减少了开发人员在实现与地理定位相关的功能方面的工作。是的，这是一个需要用户许可才能工作的功能。用户会收到提示，允许 Web 应用程序访问他们的位置详情。

## 拖放

拖放是一个一直存在的功能，但只能使用一些插件来实现。好消息是现在它是 HTML5 标准的一部分。通过利用这个功能，可以定义许多新的控件，因为我们还有自定义语义功能，可以用来定义我们自己的自定义控件。

网络应用程序使用许多不同的控件或小部件以更加用户友好的方式显示数据。对于大规模应用程序，列表和网格是显示数据最重要的控件，拖放起着非常重要的作用。显示日历或项目时间表的控件需要拖放功能，以使其更易用。一些基本的交互包括：

+   在列表中重新排列项目

+   从一个列表中移动项目到另一个列表

+   重新排列布局

+   在画布上拖动项目

+   从计算机拖动文件到浏览器

有许多很好的拖放功能的例子。不同的公司已经实现并制作了自己的组件库，其中实现了拖放功能。一些例子包括 Sencha、jQueryUI、KineticJS、Kendo UI 等。

## Web workers

Web workers 只是在后台运行的 JavaScript。JavaScript 主要用于在运行时操作网页的 HTML，并且只使用一个主线程。Web workers 使得在后台运行一段 JavaScript 代码而不影响当前进程成为可能。通常，每当我们在 JavaScript 中运行一个进程时，它以队列方式运行，这意味着一次只执行一个进程。它会在一段时间内阻塞整个 UI，你也无法点击按钮。这对应用程序的性能产生了巨大影响。这也是为什么更大的网络应用程序在选择 HTML 时犹豫不决的原因之一，但是 Web workers 肯定会改变这一点。

## JavaScript

HTML 页面是静态的；为了使它们动态和交互，使用 JavaScript。JavaScript 被称为 Web 的语言。它基于**ECMAScript**，每个浏览器都运行 JavaScript。从点击按钮、导航到页面、调用服务等所有交互都是由 JavaScript 完成的。

有许多使用 JavaScript 构建的框架，以使脚本编写更加容易：其中一个主要使用的框架是 jQuery。它为用户提供了以可读和有意义的方式使用 DOM 事件、功能和 API 的灵活性。

## 现代服务器

JavaScript 正在快速改进。大多数开发人员现在都在使用 JavaScript 进行客户端处理。**Node.js**服务器的引入改变了开发人员的工作范围。以前，开发人员使用不同的服务器，为此他们不得不学习许多不同的语言。Node.js 消除了这一差距，并为开发人员提供了一个基于 JavaScript 的构建服务器的平台。

建立在 Node.js 平台上的 JavaScript 服务器非常简单易用，也提高了生产力。开发人员可以在很短的时间内创建一个服务器并运行它。在 Node.js 中创建服务器非常容易，并且具有许多功能，例如使用不同的可用包进行实时数据传输。有许多为 Node.js 构建的框架，例如**Express.js**，它有助于加快开发过程。

Node.js 是免费平台，并提供许多可以自由分发的不同包。**Node** **Package Manager** (**NPM**)管理应用程序的依赖关系。它也是一个版本管理器。

## WebSockets

随着网络应用程序的增长，对支持全双工通信的实时数据的需求也在增加。实时通信一直很难实现，人们过去使用 Flash 来实现这一点。之所以使用类似 Flash 的插件，是因为这一功能在 HTML 标准中缺失。所以每当我们想在 HTML 中实现这样的机制时，我们使用轮询机制，这在性能方面是非常昂贵的过程。

HTML5 已经准备好了所有需要的功能，以满足良好的网络应用程序的需求。WebSockets 是 HTML5 标准的一部分，WebSocket API 完全可供利用。

WebSockets 为客户端和服务器之间提供了全双工通信，基本上允许数据在需要时轻松传输，而不像轮询机制那样在间隔上不断向服务器发送请求以检查变化。WebSockets 可以从服务器或客户端发送数据，基本上打开了一个连接桥，允许双方进行数据传输。WebSockets 已经消除了使用第三方插件的需求，使 HTML 开发人员能够直接使用 WebSockets API 进行实现。

# 总结

在本章中，我们已经了解了现代 Web 的重要元素，以及 HTML5 标准带给我们的增强功能。我们已经介绍了 WebSockets，在下一章中，我们将看到 WebSockets 在客户端和服务器端的实现。
