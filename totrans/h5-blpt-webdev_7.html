<html><head></head><body><div><div><div><div><h1 class="title"><a id="ch07"/>Chapter 7. Automate Deployment With the Build Script</h1></div></div></div><p>We are ready to deploy our site! But before we do that, we should ensure we minimize all our scripts and optimize the images, so that these pages load as quickly as possible anywhere in the world. We can automate these tasks by executing a script on the command line. Let us look at the options we have.</p><div><div><div><div><h1 class="title"><a id="ch07lvl1sec43"/>The build script</h1></div></div></div><p>Once you are <a id="id377" class="indexterm"/>done with your project, you would like to generate files that strip comments and are optimized for loading quickly. There are software build systems<a id="id378" class="indexterm"/> that are typically used in software projects with similar goals. HTML5 Boilerplate's build scripts provide tasks scoped to what a typical web development project would need.</p><p>The script should be used only after you have confirmed your project is ready for deployment and it has been well tested. The build script merely automates the process of removing comments, optimizing files, and making sure the files are production ready.</p><p>There are currently two kinds of build scripts that are actively maintained by HTML5 Boilerplate contributors; these are explored in the following section.</p><div><div><div><div><h2 class="title"><a id="ch07lvl2sec74"/>Ant build script</h2></div></div></div><p>The Ant build script<a id="id379" class="indexterm"/> is a set of files that work on top of the <a id="id380" class="indexterm"/>Apache Ant build system (<code class="literal">ant.apache.org/</code>) that has been available since the early days of HTML5 Boilerplate. It offers a variety of options, described as <a id="id381" class="indexterm"/>follows:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Publishes files to test, development, and production environments</li><li class="listitem" style="list-style-type: disc">Checks syntax and code quality of your script files with <strong>JSHint</strong> or <strong>JSLint</strong>, or your stylesheets with <strong>CSSLint</strong></li><li class="listitem" style="list-style-type: disc">Concatenates<a id="id382" class="indexterm"/> and minifies all your JavaScript files into a single file and updates the HTML pages with reference to this new file</li><li class="listitem" style="list-style-type: disc">Cleans up and tidies HTML markup by removing comments, whitespaces, and compressing inline styles and scripts</li><li class="listitem" style="list-style-type: disc">Concatenates and minifies all your stylesheets and updates the HTML pages with reference to the new file instead of multiple CSS files</li><li class="listitem" style="list-style-type: disc">Compiles style preprocessor files such as Less or Sass into the resulting CSS stylesheets and updates references in HTML pages</li><li class="listitem" style="list-style-type: disc">Optimizes PNG and JPEG images within the <code class="literal">img</code> folder using OptiPNG from <code class="literal">optipng.sourceforge.net/</code> and JPEGTran from <code class="literal">jpegclub.org/jpegtran/</code> respectively</li><li class="listitem" style="list-style-type: disc">Builds documentation from your scripts using JSDoc3 from <code class="literal">github.com/jsdoc3/jsdoc</code></li></ul></div></div><div><div><div><div><h2 class="title"><a id="ch07lvl2sec75"/>Node build script</h2></div></div></div><p>A new build script<a id="id383" class="indexterm"/> that builds on top of Node, found at <code class="literal">nodejs.org/</code>, is under active development. While it is not out for production use yet, it offers a lot of tasks that are similar to the Ant build script with some new features described as follows:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Concatenates <a id="id384" class="indexterm"/>and minifies all your JavaScript files into a single file and updates the HTML pages with reference to this new file</li><li class="listitem" style="list-style-type: disc">Concatenates and minifies all your stylesheets and update the HTML pages with reference to the new file instead of multiple CSS files</li><li class="listitem" style="list-style-type: disc">Cleans up and tidy HTML markup by removing comments, whitespaces, and compressing inline styles and scripts</li><li class="listitem" style="list-style-type: disc">Optimizes PNG and JPEG images within the <code class="literal">img</code> folder using OptiPNG and JPEGTran respectively</li></ul></div><p>Watch the project files for changes, and automatically run the build script and reload open pages in browsers when they do.</p></div><div><div><div><div><h2 class="title"><a id="ch07lvl2sec76"/>Which build script to use?</h2></div></div></div><p>Depending on <a id="id385" class="indexterm"/>what platforms you are comfortable with, you can choose one over the other. Both the build scripts are stable enough to use to deploy your production files, so your choice is down to what you are most comfortable using.</p><p>If you already <a id="id386" class="indexterm"/>have Ant installed, the Ant build script might be an obvious choice. If you find yourself using Node frequently or using it in your projects, then the Node build script could be a good start. In this chapter, we will look at using both, so you can become comfortable with either of them.</p></div></div></div>
<div><div><div><div><h1 class="title"><a id="ch07lvl1sec44"/>Using the Ant build script</h1></div></div></div><p>First, confirm <a id="id387" class="indexterm"/>you have Ant installed on your system by entering the following in your command-line tool:</p><div><pre class="programlisting">ant–version</pre></div><p>If you do not have Ant, install it first before proceeding to the next step.</p><div><div><h3 class="title"><a id="note28"/>Note</h3><p>Ant is installed <a id="id388" class="indexterm"/>by default on Macs, while it is available as a package to install on most Linux platforms. For Windows, installing Ant is slightly more complicated. You need to install the Java SDK from <a class="ulink" href="http://www.oracle.com/technetwork/java/javase/downloads/index.html">www.oracle.com/technetwork/java/javase/downloads/index.html</a> and then download <code class="literal">WinAntcode.google.com/p/winant/</code> and point the installer to <code class="literal">Program Files/Java/jre6/bin/</code>.</p></div></div><p>Next, you need to install <strong>ant-contrib</strong>
<a id="id389" class="indexterm"/>
<a id="id390" class="indexterm"/>, a utility that makes a lot of functionality available for Ant that HTML5 build script uses. <strong>WinAnt</strong>
<a id="id391" class="indexterm"/> does this automatically, when you use it to install Ant on Windows. However, for Linux users, you can use <strong>yum</strong>
<a id="id392" class="indexterm"/> to install it as a package. On Mac, you can install MacPorts<a id="id393" class="indexterm"/> (<a class="ulink" href="http://www.macports.org/install.php">www.macports.org/install.php</a>) and then enter the following in your command-line tool (typically Terminal):</p><div><pre class="programlisting">sudo port install ant-contrib</pre></div><p>Finally, ensure that the image optimization tools are installed. For Mac users, you need to make sure you have <strong>jpegt</strong>
<strong>ran</strong>
<a id="id394" class="indexterm"/> (<a class="ulink" href="http://www.ijg.org/">www.ijg.org/</a>) and <strong>optipng</strong>
<a id="id395" class="indexterm"/> (<code class="literal">optipng.sourceforge.net/</code>) installed and on your path. You can install these two files by entering the following in your command-line terminal:</p><div><pre class="programlisting">sudoport install jpeg optipng</pre></div><div><div><h3 class="title"><a id="note29"/>Note</h3><p>The <code class="literal">PATH</code> is an environmental variable that holds a list of folders that your command-line interface searches through when you enter a command. You can learn about how to add folders to the path from <a class="ulink" href="http://www.cs.purdue.edu/homes/cs348/unix_path.html">www.cs.purdue.edu/homes/cs348/unix_path.html</a>.</p></div></div><p>If you are on Windows, <a id="id396" class="indexterm"/>the Ant build script project contains the required binaries for these image tools for you to install.</p><div><div><div><div><h2 class="title"><a id="ch07lvl2sec77"/>Installing the build script</h2></div></div></div><p>In Terminal<a id="id397" class="indexterm"/> (or your command-line tool), we will navigate to our project folder and install the build script using Git, as shown in the following screenshot:</p><div><img src="img/8505_07_01.jpg" alt="Installing the build script"/></div><p>We now have to rename the build script folder from <code class="literal">ant-build-script</code> to <code class="literal">build</code> before we continue. This is done by using the following command:</p><div><pre class="programlisting">mv ant-build-script build</pre></div><p>Once that is done, let us navigate to the build script folder by using the following command:</p><div><pre class="programlisting">cd build</pre></div><p>Now, we shall execute the build script! Go to your command-line tool and enter the following:</p><div><pre class="programlisting">ant build</pre></div><p>If you set up your build script folder correctly, then you should get the following screen:</p><div><img src="img/8505_07_02.jpg" alt="Installing the build script"/></div><p>Then, after the tasks are executed, you should get the following output:</p><div><img src="img/8505_07_03.jpg" alt="Installing the build script"/></div><p>Now, you have a brand new <code class="literal">publish</code> folder where the optimized files are stored. Let us look at what all have <a id="id398" class="indexterm"/>been optimized, by opening the <code class="literal">index.html</code> page from the <code class="literal">publish</code> folder, in Chrome browser and using the Chrome Developer Tools' <strong>Network</strong> tab to observe the files that are loaded and their associated sizes.</p><p>Please note that you must load the page with the <strong>Network</strong> tab open to log the files being requested.</p></div><div><div><div><div><h2 class="title"><a id="ch07lvl2sec78"/>Smaller image files</h2></div></div></div><p>The <strong>Network</strong> tab <a id="id399" class="indexterm"/>records all images that are fetched for use on <code class="literal">index.html</code>. We can see that the images that are fetched for the <code class="literal">index.html</code> page in the <strong>publish</strong> folder are noticeably smaller in size.</p><p>In the following screenshot, the bottom section of the screenshot shows the list of images in the <strong>publish</strong> folder, which are noticeably smaller than the images used in our original project (listed in the top section of the screenshot):</p><div><img src="img/8505_07_04.jpg" alt="Smaller image files"/></div></div><div><div><div><div><h2 class="title"><a id="ch07lvl2sec79"/>Smaller CSS file</h2></div></div></div><p>We note that<a id="id400" class="indexterm"/> before we used the build script, our CSS file was called <code class="literal">main.css</code> and was approximately 21 KB, but after using the build script, the file has been renamed and is now almost half the original size, as shown in the following screenshot:</p><div><img src="img/8505_07_05.jpg" alt="Smaller CSS file"/></div></div><div><div><div><div><h2 class="title"><a id="ch07lvl2sec80"/>Smaller and fewer JS files</h2></div></div></div><p>After executing <a id="id401" class="indexterm"/>the build script, you will notice that <code class="literal">main.js</code> and <code class="literal">plugin.js</code> have been combined into one. Not only have they been combined together, but they have also been minified, leading to a smaller file size of the final script file.</p><p>The <code class="literal">index.html</code> page from the <code class="literal">publish</code> folder generated via the build script invokes only four JavaScript files as shown in the bottom section of the following screenshot, compared to five JavaScript files originally placed in the folder (top section):</p><div><img src="img/8505_07_06.jpg" alt="Smaller and fewer JS files"/></div></div><div><div><div><div><h2 class="title"><a id="ch07lvl2sec81"/>No comments in files</h2></div></div></div><p>The HTML, CSS, and JS files in the <code class="literal">publish</code> folder have no comments that HTML5 Boilerplate files contain.</p></div><div><div><div><div><h2 class="title"><a id="ch07lvl2sec82"/>Build options</h2></div></div></div><p>The Ant build script<a id="id402" class="indexterm"/> has a few tasks that are not executed by default, <a id="id403" class="indexterm"/>but are available to you if you need them. The following sections explain what these tasks allow you to do.</p><div><div><div><div><h3 class="title"><a id="ch07lvl3sec36"/>Minifying markup</h3></div></div></div><p>By default,<a id="id404" class="indexterm"/> the Ant build script does not remove whitespaces from the <code class="literal">index.html</code> page when optimizing; if you want to also remove whitespaces in the HTML file and minify it, you can execute the following:</p><div><pre class="programlisting">ant minify</pre></div></div><div><div><div><div><h3 class="title"><a id="ch07lvl3sec37"/>Preventing image optimization</h3></div></div></div><p>When <a id="id405" class="indexterm"/>executing the build script, you will notice that the script takes the longest time to optimize images. If you are executing the build script to merely test the final production-ready files, then you would not have to optimize images. In this case, you should execute the following command:</p><div><pre class="programlisting">ant text</pre></div></div><div><div><div><div><h3 class="title"><a id="ch07lvl3sec38"/>Using CSSLint</h3></div></div></div><p>CSS Lint <a id="id406" class="indexterm"/>(<code class="literal">csslint.net</code>) is <a id="id407" class="indexterm"/>an open <a id="id408" class="indexterm"/>source CSS code-quality tool that performs a static analysis of your code and flags style rules that are invalid or may be the cause of problems. To use CSS Lint on your project's CSS files, just enter the following:</p><div><pre class="programlisting">ant csslint</pre></div><p>Typically, <a id="id409" class="indexterm"/>you will observe a bunch of warnings. CSS Lint has a lot of options you can set. To do this, open the <code class="literal">project.properties</code> file within the <code class="literal">config</code> folder in build. Uncomment this line by removing the <code class="literal">#</code>, by using the following command:</p><div><pre class="programlisting">#tool.csslint.opts =</pre></div><p>Enter all the options you want to use with CSS Lint after the <code class="literal">=</code> sign and save. The various options that you can use are mentioned at <code class="literal">github.com/stubbornella/csslint/tree/master/src/rules</code>.</p></div><div><div><div><div><h3 class="title"><a id="ch07lvl3sec39"/>Using JSHint</h3></div></div></div><p>JSHint<a id="id410" class="indexterm"/> (<code class="literal">jshint.com</code>) is<a id="id411" class="indexterm"/> a <a id="id412" class="indexterm"/>community-driven tool to detect errors and potential problems with your JavaScript code and enforce your team's <a id="id413" class="indexterm"/>coding conventions. To execute JSHint on your JavaScript files, go to your project and execute the following:</p><div><pre class="programlisting">ant jshint</pre></div><p>Once executed, we see a bunch of errors being listed for our <code class="literal">main.js</code>. The corrected file is included within the code for this chapter. Once corrected, you will also notice a whole slew of errors being thrown for the code in <code class="literal">plugin.js</code>. This is because we used the minified code of the smooth-scroll plugin. Let us replace it with the unminified code from the project repository at <code class="literal">github.com/kswedberg/jquery-smooth-scroll/blob/master/jquery.smooth-scroll.js</code>.</p><p>Now, we get a bunch of errors all telling us we need to use the stricter comparison operator. Let us turn this off for our current project. We can do this by opening the <code class="literal">project.properties</code> file within the <code class="literal">config</code> folder under our <code class="literal">build</code> folder and uncomment the following line<a id="id414" class="indexterm"/> that allows you to use your own options for JSHint:</p><div><pre class="programlisting">#tool.jshint.opts</pre></div><p>Change it to the following snippet:</p><div><pre class="programlisting">tool.jshint.opts = maxerr=25,eqeqeq=false</pre></div><div><div><h3 class="title"><a id="note30"/>Note</h3><p>More options are listed on the JSHint website at <code class="literal">jshint.com</code>.</p></div></div><p>Our errors have disappeared!</p></div><div><div><div><div><h3 class="title"><a id="ch07lvl3sec40"/>Setting up the SHA filenames</h3></div></div></div><p>The <a id="id415" class="indexterm"/>concatenated <a id="id416" class="indexterm"/>and minified CSS and JS filenames are set to uniquely generated strings, which ensures a cached local copy of these files never get loaded when a new production build is deployed to the server. By default, the number of characters used in the filename is <code class="literal">7</code>. You can set it to a smaller or larger number by changing the following line in <code class="literal">project.properties</code> within the <code class="literal">config</code> folder inside the <code class="literal">build</code> folder:</p><div><pre class="programlisting">#hash.length = 7</pre></div><p>Uncomment the previous line and then alter the number <code class="literal">7</code> to the number of characters you prefer, using the following syntax:</p><div><pre class="programlisting">hash.length = &lt;number of characters you prefer&gt;</pre></div></div></div><div><div><div><div><h2 class="title"><a id="ch07lvl2sec83"/>Using with Drupal or WordPress</h2></div></div></div><p>Minor<a id="id417" class="indexterm"/> changes need to be made to make sure <a id="id418" class="indexterm"/>that these Ant build scripts work as intended for Drupal. Do note that there is not much help in minifying the HTML pages as a significant portion of the markup will be generated by Drupal or WordPress.</p><div><div><div><div><h3 class="title"><a id="ch07lvl3sec41"/>Updating build.xml</h3></div></div></div><p>There is a <a id="id419" class="indexterm"/>minor change <a id="id420" class="indexterm"/>you need to make to <code class="literal">build.xml</code> to make it work with the file structure of Drupal or WordPress.</p><p>Look for <code class="literal">&lt;echo message="Minifying any unconcatenatedcss files..."/&gt;</code> within the file. Just after that line of code, change the following:</p><div><pre class="programlisting">&lt;filesetdir="${dir.source}/${dir.css}/" excludes="${concat-files}" includes="**/*.css"/&gt;</pre></div><p>To the <a id="id421" class="indexterm"/>following:</p><div><pre class="programlisting">&lt;filesetdir="${dir.source}/${dir.css}/" excludes="${concat-files}, ${dir.build.tools}/**/*.css, ${dir.intermediate}/**/*.css, ${dir.publish}/**/*.css" includes="**/*.css"/&gt;</pre></div></div><div><div><div><div><h3 class="title"><a id="ch07lvl3sec42"/>Setting up the project configuration properties</h3></div></div></div><p>In the <code class="literal">project.properties</code> file <a id="id422" class="indexterm"/>within the <code class="literal">config</code> folder of the <code class="literal">build</code> folder, <a id="id423" class="indexterm"/>add the following code: </p><div><pre class="programlisting">dir.css = .
dir.images = images
file.root.stylesheet = style.css</pre></div></div><div><div><div><div><h3 class="title"><a id="ch07lvl3sec43"/>Setting the JS file delineator</h3></div></div></div><p>WordPress or Drupal <a id="id424" class="indexterm"/>themes <a id="id425" class="indexterm"/>require you to split your markup into separate files (for example, <code class="literal">footer.php</code> for WordPress or <code class="literal">footer.tpl.php</code> for Drupal). You need to know in which of these files the following code is located:</p><div><pre class="programlisting">&lt;!-- scripts concatenated and minified via build script --&gt;
&lt;scriptsrc="img/plugins.js"&gt;&lt;/script&gt;
&lt;scriptsrc="img/main.js"&gt;&lt;/script&gt;
&lt;!-- end scripts --&gt;</pre></div><p>Use that filename (for example, <code class="literal">footer.php</code>) to set the <code class="literal">file.root.page</code> property in the <code class="literal">project.properties</code> file by using the following code:</p><div><pre class="programlisting">file.root.page = &lt;name of file&gt;</pre></div><p>A sample Drupal and WordPress theme that contains the modified build script are provided in the code for this chapter.</p></div></div></div>
<div><div><div><div><h1 class="title"><a id="ch07lvl1sec45"/>Using the Node build script</h1></div></div></div><p>The Node build script is <a id="id426" class="indexterm"/>different from the Ant build script in the following two ways:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">It installs universally and does not need to be copied from one project to the other.</li><li class="listitem" style="list-style-type: disc">All projects should be initialized with the Node build script. It is significantly more troublesome to add it on to a project that is already underway.</li></ul></div><p>The Node build script<a id="id427" class="indexterm"/> requires Node, so verify you have Node installed by entering the following command:</p><div><pre class="programlisting">node -v</pre></div><p>If you do not have Node already, you can install it from <code class="literal">nodejs.org/</code> (or by using <strong>package manager</strong> from <a class="ulink" href="http://github.com/joyent/node/wiki/Installing-Node.js-via-package-manager">github.com/joyent/node/wiki/Installing-Node.js-via-package-manager</a>.</p><div><div><div><div><h2 class="title"><a id="ch07lvl3sec44"/>Grunt</h2></div></div></div><p>
<strong>Grunt</strong> (<code class="literal">gruntjs.com/</code>) is <a id="id428" class="indexterm"/>a<a id="id429" class="indexterm"/> Node-based <a id="id430" class="indexterm"/>command-line build tool on which this Node build script is based. The Node build script provides HTML5 Boilerplate optimized tasks that plug into Grunt.</p><p>This requires using a <code class="literal">package.json</code> file along with a <code class="literal">grunt.js</code> file within your project folder, which can be set up when you initialize your project.</p></div><div><div><div><div><h2 class="title"><a id="ch07lvl2sec85"/>Installing Node build script</h2></div></div></div><p>In your <a id="id431" class="indexterm"/>command-line tool, first install the Node build script package, by entering the following command:</p><div><pre class="programlisting">npm install https://github.com/h5bp/node-build-script/tarball/master -g</pre></div><p>The Node build script can also be used as a part of a bigger build setup. If you are inclined to using it differently, take a look at all the possible ways of doing so here at <code class="literal">github.com/h5bp/node-build-script/wiki/install</code>.</p><p>Once installed, you can create your HTML5 Boilerplate project folder by initializing it.</p><div><div><div><div><h3 class="title"><a id="ch07lvl3sec45"/>Initializing your project</h3></div></div></div><p>You can <a id="id432" class="indexterm"/>choose from various options to set up a project folder for yourself. Let us use this to set up a temporary project, to learn how to use this script to start your HTML5 Boilerplate project.</p><p>Create a folder where your HTML5 Boilerplate project should be. Navigate to it within your command-line tool and enter the following command:</p><div><pre class="programlisting">h5bpinit</pre></div><p>This will start setting up a whole set of command-line interactions for you to choose from. It is mostly used to set up information for package management that will be used by Grunt.</p><p>Once you have done that, you have three options to choose from for setting up the files you want to start with; these options are as follows:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">[D]efault</code>: Standard set of files for HTML5 Boilerplate.</li><li class="listitem" style="list-style-type: disc"><code class="literal">[C]ustom</code>: Get all the standard files with the option of choosing to rename <code class="literal">js/</code>, <code class="literal">css/</code>, or <code class="literal">img/</code> folders. You would typically want to do this if your files are going to be used as templates for other systems such as Drupal or WordPress.</li><li class="listitem" style="list-style-type: disc"><code class="literal">[S]illy</code>: Prompts to rename every folder/file in HTML5 Boilerplate. You are least likely to use this option, unless you are a semantic perfectionist.</li></ul></div><p>After you<a id="id433" class="indexterm"/> choose the type of installation you want to do, there are also more questions that are asked. Note that if you press <em>Enter</em>, the default value as indicated within parenthesis will be set.</p><p>This will then download the latest version of HTML5 Boilerplate from the Github repository for you to start as your base.</p></div><div><div><div><div><h3 class="title"><a id="ch07lvl3sec46"/>Using the Node build script with an existing project</h3></div></div></div><p>It is not impossible<a id="id434" class="indexterm"/> to use the script with an existing project, but it's just a bit more tedious. There is work underway in the project to make this happen at <code class="literal">github.com/h5bp/node-build-script/issues/55</code>, but until then, the following is how we can use it with our Sun and Sand website:</p><div><ol class="orderedlist arabic"><li class="listitem">First, create a temporary folder, and execute the Node build script to initialize an empty project from the command line as described in the earlier section.</li><li class="listitem">Then, copy only <code class="literal">package.json</code> and <code class="literal">grunt.js</code> into your project folder.</li></ol></div><p>You can see the code in the <code class="literal">nimbu.in/h5bp-book/chapter-7-node-init/</code> folder to see this in action.</p></div></div><div><div><div><div><h2 class="title"><a id="ch07lvl2sec86"/>Using the Node build script to build your project</h2></div></div></div><p>Navigate to the <a id="id435" class="indexterm"/>Sun and Sand project folder (that you initialized<a id="id436" class="indexterm"/> it in the previous section) in your command-line tool and enter the following command:</p><div><pre class="programlisting">h5bpbuild:default</pre></div><p>This will combine <a id="id437" class="indexterm"/>the files and the results are published in the <code class="literal">publish</code> folder just like the Ant build script. You can also use these other build options like the Ant build script.</p><div><div><div><div><h3 class="title"><a id="ch07lvl3sec47"/>Text</h3></div></div></div><p>If you would<a id="id438" class="indexterm"/> like to leave out compressing images when building your project, then use the following command:</p><div><pre class="programlisting">h5bpbuild:text</pre></div></div><div><div><div><div><h3 class="title"><a id="ch07lvl3sec48"/>Minify</h3></div></div></div><p>If you would <a id="id439" class="indexterm"/>like to additionally minify HTML files, then use the following command:</p><div><pre class="programlisting">h5bpbuild:minify</pre></div><p>The results are similar to what you would find with Ant build script; the following screenshot shows the result of the minification process:</p><div><img src="img/8505_07_07.jpg" alt="Minify"/></div><p>There are some additional options available that you don't get with Ant build script.</p></div><div><div><div><div><h3 class="title"><a id="ch07lvl3sec49"/>Server</h3></div></div></div><p>This will <a id="id440" class="indexterm"/>open a local server instance you can immediately preview your website on. This is useful when you want to test the pages where protocol-relative URLs are used to link to files. To do this, simply navigate to your project folder in the command-line tool and enter the following command:</p><div><pre class="programlisting">h5bp server</pre></div><p>You will see the server being started for both the <code class="literal">publish</code> folder and the <code class="literal">intermediate</code> folder, as shown in the following screenshot:</p><div><img src="img/8505_07_08.jpg" alt="Server"/></div><p>Then, open <code class="literal">http://localhost:3001</code> to view the published site.</p></div><div><div><div><div><h3 class="title"><a id="ch07lvl3sec50"/>Connect</h3></div></div></div><p>Using this <a id="id441" class="indexterm"/>command, you can see your page reload on browsers it is open in as soon as you have made changes to any asset within the project. This saves you from refreshing the page manually to see the change. To do this, just navigate to your project folder in the command-line tool and enter the following command:</p><div><pre class="programlisting">h5bp connect</pre></div></div></div><div><div><div><div><h2 class="title"><a id="ch07lvl2sec87"/>Using with Drupal or WordPress</h2></div></div></div><p>It is fairly trivial to initialize an HTML5 Boilerplate project with Node build script and then convert it into a<a id="id442" class="indexterm"/> template you are <a id="id443" class="indexterm"/>building for Drupal or WordPress. First, make sure you choose the <code class="literal">Custom</code> option when executing <code class="literal">h5bp init</code>. Then, when setting the folders, set <code class="literal">inc</code> as the folder where your stylesheet will be, and <code class="literal">images</code> as the name of the folder that would contain your template images. When you are prompted again, enter in the same values and the project framework will be generated for you. Make sure you replace <code class="literal">index.html</code> with your template files.</p><p>Once you have done this, open the <code class="literal">grunt.js</code> file in your project folder and confirm that the stylesheet's folder is set to the parent folder by using the following code:</p><div><pre class="programlisting">css: {
      'style.css': ['*.css']
    },</pre></div><p>Make sure that only JavaScript files and stylesheets get prefixed with the SHA filenames, by editing or removing <a id="id444" class="indexterm"/>images from being renamed. This is done by using the following code:</p><div><pre class="programlisting">rev: {
js: 'js/**/*.js',
css: '*.css',
},</pre></div><p>The script also needs to know the new location of the <code class="literal">images</code> folder. We can do this by setting the source<a id="id445" class="indexterm"/> and destination folders for images, as shown in the following code snippet:</p><div><pre class="programlisting">img: {
dist: {
src: 'images',
dest: 'images'
      }
    },</pre></div></div></div>
<div><div><div><div><h1 class="title"><a id="ch07lvl1sec46"/>Next steps</h1></div></div></div><p>Once we are satisfied with our production files in the <code class="literal">publish</code> folder, then we can move it to our hosting provider to replace the files that make our website.</p><p>Ideally, you would be using a Version Control System to do this, so you can quickly roll back an update in the unlikely event of this update making some page unavailable.</p><p>If you are only creating a template for Drupal or WordPress, then it may help to move this to within the WordPress folder on the server that is under a Version Control System.</p><p>Alternatively, you can compress your project and then copy the files to the server where they can be decompressed and used. The Node build script provides an option to do this. Go to your project folder in your command-line tool and enter the following command:</p><div><pre class="programlisting">h5bptar –-input publish –-output &lt;project-name&gt;.tgz</pre></div><p>Use the name that best describes your project instead of <code class="literal">&lt;project-name&gt;</code>. Then, copy the <code class="literal">&lt;project-name&gt;.tgz</code> to your server and expand it into the folder you would want the files in.</p></div>
<div><div><div><div><h1 class="title"><a id="ch07lvl1sec47"/>Summary</h1></div></div></div><p>In this chapter, we learned how to use two kinds of build scripts that are available from the HTML5 Boilerplate team. We also looked at how we can use them both with Drupal or WordPress templates. We also looked at what we can do once the files have been built.</p><p>In the next chapter, we will look at some advanced tasks you can take on, now that you know how to create and deploy projects using HTML5 Boilerplate.</p></div></body></html>